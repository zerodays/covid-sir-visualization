(this.webpackJsonpsir_visualization=this.webpackJsonpsir_visualization||[]).push([[0],{192:function(e,t,a){"use strict";a.r(t);var i,n=a(0),o=a.n(n),s=a(24),r=a.n(s),c=a(11),l=a(18),d=a(14),h=a(10),b=a(16),j=a(15),u=a(6),p=a(13),m=a(2),v=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).canvasRef=o.a.createRef(),e.countInfectedNeighbours=function(t,a,i){for(var n=e.props,o=n.widthPoints,s=n.heightPoints,r=0,c=i-1;c<i+2;c++)for(var l=a-1;l<a+2;l++)c===a&&l===i||c<0||l<0||c>=s||l>=o||1===t[c][l]&&r++;return r},e.paintRect=function(t,a,i,n){var o=e.props.rectSize;n.fillStyle=e.getColorFromState(i[a][t]),n.fillRect(o*t,o*a,o,o)},e.getNewStateForPoint=function(t,a,i){if(2===t[i][a])return 2;if(1===t[i][a])return Math.random()<e.props.gamma?2:1;var n=e.countInfectedNeighbours(t,a,i);return Math.random()<n*e.props.betta/8?1:0},e.getColorFromState=function(t){var a=e.props,i=a.infectedColor,n=a.susceptibleColor,o=a.removedColor;return 1===t?i:2===t?o:n},e.emptyField=function(){for(var t=e.props,a=t.widthPoints,i=t.heightPoints,n=Array(i),o=0;o<i;o++)n[o]=Array(a).fill(0);return n},e.evolve=function(t,a){for(var i=e.props,n=i.widthPoints,o=i.heightPoints,s=e.emptyField(),r=0,c=0,l=0,d=0;d<o;d++)for(var h=0;h<n;h++){var b=e.getNewStateForPoint(t,h,d);s[d][h]=b,0===b?r++:1===b?c++:2===b&&l++,s[d][h]!==t[d][h]&&e.paintRect(h,d,s,a)}var j=r+c+l;return[s,r/=j,c/=j,l/=j]},e.tick=function(){var t=e.getCanvasContext(),a=(new Date).getTime(),n=e.evolve(i,t),o=Object(l.a)(n,4),s=o[0],r=o[1],c=o[2],d=o[3];return i=s,console.log("time for evolution: ".concat((new Date).getTime()-a," ms")),[r,c,d]},e.addSeed=function(t,a){i[a][t]=1,e.paintRect(t,a,i,e.getCanvasContext())},e.reset=function(){var t=e.props,a=t.widthPoints,n=t.heightPoints,o=t.rectSize;i=e.emptyField(),e.getCanvasContext().clearRect(0,0,a*o,n*o)},e.getCanvasContext=function(){return e.canvasRef.current.getContext("2d")},e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){i=this.emptyField()}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.widthPoints,i=e.heightPoints,n=e.rectSize,o=e.susceptibleColor;return Object(m.jsx)("div",{className:t.root,style:{width:a*n,height:i*n},children:Object(m.jsx)("canvas",{ref:this.canvasRef,className:t.canvas,style:{backgroundColor:o,transform:"scale(".concat(this.props.zoom,")"),width:a*n,height:i*n},width:a*n,height:i*n})})}}]),a}(n.Component),f=Object(u.a)((function(e){return{root:{position:"relative",overflow:"hidden"},canvas:{position:"absolute"}}}))(v),x=a(186),O=a(191),y=a(187),g=a(188),C=a(26),S=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=this.props.classes;return Object(m.jsx)(x.a,{className:e.root,children:Object(m.jsx)(O.a,{p:1,className:e.expandable,children:Object(m.jsxs)(y.a,{container:!0,direction:"row",spacing:1,children:[Object(m.jsx)(y.a,{item:!0,xs:12,children:Object(m.jsx)(g.a,{variant:"subtitle2",children:"Help"})}),Object(m.jsx)(y.a,{item:!0,xs:12,children:Object(m.jsxs)(g.a,{variant:"caption",children:["This is a simplified discrete representation of the epidemiological (local) ",Object(m.jsx)("a",{href:"https://en.m.wikipedia.org/wiki/Compartmental_models_in_epidemiology#The_SIR_model",children:"SIR model"}),"."]})}),Object(m.jsxs)(y.a,{item:!0,xs:12,children:[Object(m.jsx)(g.a,{variant:"subtitle2",children:"Navigation"}),Object(m.jsx)(g.a,{variant:"caption",children:Object(m.jsxs)("ul",{children:[Object(m.jsxs)("li",{children:["Press ",Object(m.jsx)("span",{className:e.key,children:"Enter"})," to move to the next day. First infection will appear in the center of the screen on ",Object(m.jsx)("b",{children:"day 1"}),"."]}),Object(m.jsxs)("li",{children:[Object(m.jsx)("span",{className:e.key,children:"Scroll"})," to zoom in and out of the visualization."]}),Object(m.jsxs)("li",{children:["Use ",Object(m.jsx)("b",{children:"control panel on the right"})," to adjust simulation parameters."]}),Object(m.jsxs)("li",{children:["Hover over the ",Object(m.jsx)("b",{children:"graph icon in the left bottom conner"})," to view number of susceptible/infected/removed individuals over time."]})]})})]}),Object(m.jsx)(y.a,{item:!0,xs:12,children:Object(m.jsx)(g.a,{variant:"subtitle2",children:"Legend"})}),Object(m.jsx)(y.a,{item:!0,xs:12,children:Object(m.jsxs)(g.a,{variant:"caption",children:[Object(m.jsx)("span",{className:e.legend,style:{backgroundColor:this.props.susceptibleColor}}),"Susceptible individuals."]})}),Object(m.jsx)(y.a,{item:!0,xs:12,children:Object(m.jsxs)(g.a,{variant:"caption",children:[Object(m.jsx)("span",{className:e.legend,style:{backgroundColor:this.props.infectedColor}}),"Infected individuals."]})}),Object(m.jsx)(y.a,{item:!0,xs:12,children:Object(m.jsxs)(g.a,{variant:"caption",children:[Object(m.jsx)("span",{className:e.legend,style:{backgroundColor:this.props.removedColor}}),"Removed (deceased or immune) individuals."]})})]})})})}}]),a}(n.Component),w=Object(u.a)((function(e){return{root:{maxWidth:256},key:{backgroundColor:C.a[300],borderRadius:2,borderWidth:2,borderColor:C.a[300],borderStyle:"solid",paddingX:8,paddingY:2},expandable:{maxHeight:20,transition:"max-height 300ms ease-out","&:hover":{maxHeight:490}},legend:{width:12,height:12,borderColor:C.a[700],borderWidth:1,borderStyle:"solid",borderRadius:2,display:"inline-block",marginRight:6}}}))(S),R=a(193),k=a(189),P=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=this,t=this.props.classes;return Object(m.jsx)(x.a,{className:t.root,children:Object(m.jsx)(O.a,{p:1,children:Object(m.jsxs)(y.a,{container:!0,direction:"row",justify:"center",spacing:1,children:[Object(m.jsx)(y.a,{item:!0,xs:12,children:Object(m.jsxs)(g.a,{variant:"subtitle2",children:["Control panel ",Object(m.jsxs)("span",{className:t.day,children:["Day ",this.props.day]})]})}),Object(m.jsx)(y.a,{item:!0,xs:12}),Object(m.jsxs)(y.a,{item:!0,xs:12,children:[Object(m.jsxs)(g.a,{variant:"body2",children:["\u03b2 ",Object(m.jsx)("small",{children:" - probability of being infected after a contact with an infectious individual"})]}),Object(m.jsx)(O.a,{pt:4,children:Object(m.jsx)(R.a,{value:this.props.betta,min:0,max:1,step:.01,onChange:function(t,a){return e.props.onChangeBetta(a)},valueLabelDisplay:"on"})})]}),Object(m.jsx)(y.a,{item:!0,xs:12}),Object(m.jsxs)(y.a,{item:!0,xs:12,children:[Object(m.jsxs)(g.a,{variant:"body2",children:["\u03b3 ",Object(m.jsx)("small",{children:' - probability of being "removed" (either dying or becoming non-susceptible)'})]}),Object(m.jsx)(O.a,{pt:4,children:Object(m.jsx)(R.a,{value:this.props.gamma,min:0,max:1,step:.01,onChange:function(t,a){return e.props.onChangeGamma(a)},valueLabelDisplay:"on"})})]}),Object(m.jsx)(y.a,{item:!0,xs:12}),Object(m.jsx)(y.a,{item:!0,children:Object(m.jsx)(k.a,{size:"small",variant:"raised",onClick:this.props.onReset,color:"secondary",children:"Reset simulation"})})]})})})}}]),a}(n.Component),N=Object(u.a)((function(e){return{root:{width:256},day:{float:"right"}}}))(P),z=a(168),I=a.n(z),M={colors:[p.a.grey[500],p.a.red[400],p.a.blue[400]],title:{text:"SIR relative values (refreshed every 21 days)"},animations:{enabled:!1},chart:{type:"area"},dataLabels:{enabled:!1},stroke:{curve:"smooth"},xaxis:{type:"number",tickAmount:8,labels:{formatter:function(e){return"Day ".concat(21*e)}}},yaxis:{labels:{formatter:function(e){return"".concat(Math.round(100*e)," %")}}},tooltip:{title:"Day"},markers:{size:0}},W=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){return Object(m.jsx)(x.a,{children:Object(m.jsx)(O.a,{pr:2,pt:2,children:Object(m.jsx)(I.a,{width:512,options:M,series:[{name:"Susceptible",data:this.props.dataS},{name:"Infected",data:this.props.dataI},{name:"Removed",data:this.props.dataR}]})})})}}]),a}(n.Component),D=Object(u.a)({})(W),F=p.a.grey[200],_=p.a.red[400],H=p.a.blue[400],L=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(d.a)(this,a);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).fieldRef=o.a.createRef(),e.state={seedCalled:!1,day:0,zoom:1,widthPoints:null,heightPoints:null,betta:.8,gamma:.2,dataS:[],dataI:[],dataR:[]},e.iterateWithSeed=function(t){if(13===t.keyCode){var a=e.fieldRef.current;if(!e.state.seedCalled){var i=document.body.clientWidth,n=document.body.clientHeight,o=Math.ceil(i/3/2),s=Math.ceil(n/3/2);a.addSeed(o,s),e.setState({seedCalled:!0})}var r=a.tick(),d=Object(l.a)(r,3),h=d[0],b=d[1],j=d[2];e.state.day%21===0?e.setState((function(e){return{day:e.day+1,dataS:[].concat(Object(c.a)(e.dataS),[h]),dataI:[].concat(Object(c.a)(e.dataI),[b]),dataR:[].concat(Object(c.a)(e.dataR),[j])}})):e.setState((function(e){return{day:e.day+1}}))}},e.onScroll=function(t){var a=e.state.zoom-t.deltaY/100;a=Math.min(3,Math.max(1,a)),e.setState({zoom:a})},e.onChangeBetta=function(t){return e.setState({betta:t})},e.onChangeGamma=function(t){return e.setState({gamma:t})},e.onReset=function(){e.setState({seedCalled:!1,day:0,dataS:[],dataI:[],dataR:[]},e.fieldRef.current.reset)},e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.iterateWithSeed);var e=document.body.clientWidth,t=document.body.clientHeight,a=Math.ceil(e/3),i=Math.ceil(t/3);this.setState({widthPoints:a,heightPoints:i})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.iterateWithSeed)}},{key:"render",value:function(){var e=this.props.classes;return Object(m.jsxs)("div",{className:e.root,onKeyDown:this.iterateWithSeed,onWheel:this.onScroll,children:[Object(m.jsx)("div",{className:e.fieldContainer,children:null==this.state.widthPoints?null:Object(m.jsx)(f,{ref:this.fieldRef,widthPoints:this.state.widthPoints,heightPoints:this.state.heightPoints,rectSize:3,susceptibleColor:F,infectedColor:_,removedColor:H,betta:this.state.betta,gamma:this.state.gamma,zoom:this.state.zoom})}),Object(m.jsx)("div",{className:e.helpCardContainer,children:Object(m.jsx)(w,{susceptibleColor:F,infectedColor:_,removedColor:H})}),Object(m.jsx)("div",{className:e.controlPanelContainer,children:Object(m.jsx)(N,{betta:this.state.betta,gamma:this.state.gamma,day:this.state.day,onChangeBetta:this.onChangeBetta,onChangeGamma:this.onChangeGamma,onReset:this.onReset})}),Object(m.jsx)("div",{className:e.chartViewContainer,children:Object(m.jsx)(D,{dataS:this.state.dataS,dataI:this.state.dataI,dataR:this.state.dataR})})]})}}]),a}(n.Component),A=Object(u.a)((function(e){return{root:{overflow:"hidden",height:"100vh",width:"100vw",position:"relative"},fieldContainer:{position:"absolute",top:0,left:0},helpCardContainer:{position:"absolute",top:16,left:16,opacity:.6,transition:"opacity 200ms ease-in-out","&:hover":{opacity:1}},controlPanelContainer:{position:"absolute",right:16,top:16,opacity:.6,transition:"opacity 200ms ease-in-out","&:hover":{opacity:1}},chartViewContainer:{position:"absolute",left:16,bottom:16,opacity:.6,transition:"opacity 200ms ease-in-out","&:hover":{opacity:1}}}}))(L);r.a.render(Object(m.jsx)(o.a.StrictMode,{children:Object(m.jsx)(A,{})}),document.getElementById("root"))}},[[192,1,2]]]);
//# sourceMappingURL=main.0cad00b4.chunk.js.map